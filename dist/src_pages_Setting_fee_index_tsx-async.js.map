{"version":3,"sources":["src/pages/Setting/fee/index.tsx","src/services/setting/fee.ts"],"sourcesContent":["import { _getAllFee, _updateVendPopupsFee } from \"@/services/setting/fee\";\nimport { QuestionCircleOutlined, QuestionOutlined } from \"@ant-design/icons\";\nimport {\n  ProCard,\n  ProDescriptions,\n  ProForm,\n  ProFormText,\n} from \"@ant-design/pro-components\";\nimport { useRequest } from \"@umijs/max\";\nimport { Button, Divider, FormInstance, message, Tooltip } from \"antd\";\nimport useMessage from \"antd/es/message/useMessage\";\nimport React, { useRef, useState } from \"react\";\nexport default function Index() {\n  /**********************************狀態管理**********************************/\n  const [stripeFee, setStripeFee] = useState<{\n    percentage: number;\n    fixed_dollar: number;\n    billing_percentage: number;\n  }>();\n  const formRef = useRef<FormInstance>();\n  const [readOnly, setReadOnly] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const [messageApi, contextHolder] = message.useMessage();\n  const { data, refresh } = useRequest(_getAllFee, {\n    onSuccess: (res) => {\n      setStripeFee(res.stripe);\n      formRef.current?.setFieldsValue(res.vendpopups);\n    },\n  });\n  /**********************************狀態管理**********************************/\n  /**********************************組件初始化**********************************/\n  /**********************************組件初始化**********************************/\n  /**********************************異步函數**********************************/\n  /**********************************異步函數**********************************/\n  return (\n    <ProCard title=\"Fee setting\" className=\"min-h-[90vh]\">\n      {contextHolder}\n      <ProCard\n        title={\n          <>\n            Stripe Fee\n            <Tooltip title=\"Stripe Fee can not be changed\">\n              <QuestionCircleOutlined className=\"ml-2 opacity-50\" />\n            </Tooltip>\n          </>\n        }\n        colSpan=\"50%\"\n      >\n        <ProDescriptions dataSource={stripeFee} column={1} layout=\"horizontal\">\n          <ProDescriptions.Item label=\"Fee Percentage\">\n            {stripeFee?.percentage}\n          </ProDescriptions.Item>\n          <ProDescriptions.Item label=\"Fee Fixed dollar\">\n            {stripeFee?.fixed_dollar}\n          </ProDescriptions.Item>\n          <ProDescriptions.Item label=\"Billing Percentage\">\n            {stripeFee?.billing_percentage}\n          </ProDescriptions.Item>\n        </ProDescriptions>\n      </ProCard>\n\n      <Divider type=\"vertical\" className=\"min-h-[90vh]\" />\n      <ProCard\n        title=\"Vend Popups Fee\"\n        extra={\n          <div className=\"flex gap-2\">\n            {!readOnly && (\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                loading={loading}\n                onClick={() => {\n                  setLoading(true);\n                  messageApi.loading(\"Updating...\");\n                  formRef.current?.submit();\n                }}\n              >\n                Save\n              </Button>\n            )}\n            <Button\n              type=\"primary\"\n              disabled={loading}\n              onClick={() => setReadOnly(!readOnly)}\n            >\n              {readOnly ? \"Edit\" : \"Cancel\"}\n            </Button>\n          </div>\n        }\n      >\n        <ProForm\n          formRef={formRef}\n          disabled={readOnly}\n          readonly={readOnly}\n          submitter={false}\n          layout=\"horizontal\"\n          grid={true}\n          onFinish={async (values) => {\n            await _updateVendPopupsFee({\n              percentage: values.percentage,\n            })\n              .then(() => {\n                messageApi.destroy();\n                messageApi.success(\"Success\");\n                setLoading(false);\n                setReadOnly(true);\n                refresh();\n              })\n              .catch(() => {\n                setLoading(false);\n                messageApi.destroy();\n                messageApi.error(\"Failed\");\n                setReadOnly(true);\n                refresh();\n              });\n          }}\n        >\n          <ProFormText\n            colProps={{ span: 8 }}\n            name=\"percentage\"\n            label=\"Fee Percentage\"\n          />\n        </ProForm>\n      </ProCard>\n    </ProCard>\n  );\n}\n","import { request } from \"@umijs/max\";\n\nexport const _getAllFee = async (): Promise<API.DefaultObjectResponse> => {\n  return request(\"/api/v1/admin/private/fee/info\", {\n    method: \"get\",\n  });\n};\n\nexport const _updateVendPopupsFee = async (values: {\n  percentage: number;\n}): Promise<API.DefaultObjectResponse> => {\n  return request(\"/api/v1/admin/private/fee/info\", {\n    method: \"put\",\n    data: { vendpopups: { ...values } },\n  });\n};\n"],"names":[],"mappings":"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"}